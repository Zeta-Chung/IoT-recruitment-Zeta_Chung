
# 任务一 git项目
## git知识学习
### 两种版本控制系统

  * 集中式版本控制系统：只在中央服务器中有完整的版本库，设备从服务器下载、修改版本后再上传，必须联网使用。

  * 分布式版本控制系统(git所属类型)：在每台电脑上都有完整的版本库，可以在本地完成版本的更新，再通过中央服务器完成设备之间的版本“交换”，不是随时需要联网。

### 工作区、暂存区和版本库
  * 工作区：在本地计算机上的项目目录，用户在这里进行文件的创建、修改和删除操作。工作区包含了当前项目的所有文件和子目录。

  * 暂存区：一个临时存储区域，它包含了即将被提交到版本库中的文件快照，在提交之前，用户可以选择性地将**工作区**中的修改添加到**暂存区**。可通过多次```git add```添加好所有文件后通过```git commit```一次性提交到**版本库**。

  * 版本库：包含项目的所有版本历史记录。

### 分支
* **定义：指向提交对象的一个指针**

  * 每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。

  * ```HEAD```是指向当前分支的指针。

  * 主分支即master。

* 创建新分支时，新建一个分支名指针指向当前提交，再将HEAD指向分支名指针，就完成了分支的切换。
* 合并分支时，将一个分支指向另一个分支的当前提交即可。
* 在一个分支上修改文件时，其他分支不受影响。
* 当两个分支对同一文件进行了不同修改，则无法正常合并，必须修改至内容相同才可合并。
### git命令

  *  ```git config XXX```： 修改git的各种配置信息。

  * ```git init```：在当前文件夹中创建仓库。

  * ```git add XXX```：将文件添加到git仓库中（p.s.文件需要与仓库位于同一文件夹下）。

  * ```git commit -m"XXX"```：在git中记录对文件的修改，并提交到仓库，***-m***后是用户对本次提交的说明。

  * ```git log```： 显示最近到最远的提交日志。  

    ```git log --pretty==oneline```：仅显示每次提交的版本号，更加整洁。

  * ```git reset --参数 版本```：将版本回退
    * ```--hard```参数：回退至以前版本的已提交状态。(撤销工作区中所有未提交的修改内容，将暂存区与工作区都回到上一次版本，并删除之前的所有信息提交)

    * ```--soft```参数：回退至以前版本的未提交状态。

    * ```--mixed```参数（默认）：回退至以前版本已暂存但未提交状态。(重置暂存区的文件与上一次的commit保持一致，工作区文件内容保持不变)

    * 版本表示： 
    1. 用**HEAD**表示当前版本，HEAD后加几个^就表示本次之前第几个版本，回退太多版本时可以用**HEAD~数字**来表示之前的第几个版本。

    2. 用每个版本特定的版本号来表示，可以不写全，只写前几位（也不能太少）。
  
  * ```git checkout --文件名```：将文件在工作区内的修改全部撤销（用暂存区内的文件替换工作区文件，若已修改但未添加至暂存区，直接回退至上一个提交版本）。   
    * checkout后加参数 -b，表示创建并切换至新分支。  

  * ```git reflog```：查看所有命令历史。

  * ```git status```：查看当前分支的状态。

  * ```git diff HEAD --文件名```：查看工作区和最新版本库里文件的区别。

  * ```git rm --文件名```：将文件从工作区和暂存区删除。(注意：未提交至版本库的文件删除后无法恢复)
  
  * ```git push 远程库名 本地分支名:远程分支名```：将本地分支中的更新上传至远程库中的分支
    * ```-u```参数：将本地的分支与远程库中指定的分支建立联系，此后直接使用```git push```即可将该分支的更新上传至远程库中的相应分支。
  
  * ```git clone git@github.com:XXX.git```：将远程库克隆到本地

  * ```git pull 远程库名 远程分支名：本地分支名```：从远程分支获取最新的提交记录，并合并至本地分支。

  * ```git merge 分支名```：将指定的分支合并到当前分支上。
    * 自动合并分支时会产生Fast-forward信息，
  * ```git branch```：查看所有分支（当前所在分支有 <strong>*</strong> 标明）
    * ```git branch 分支名```：创建一个分支。

    * ```-d```参数：后接某个分支名，删除这个分支。

  * ```git switch 分支名```：切换到某个分支。
    * ```-c```参数：后接分支名，创建并切换到某个分支。

## git初始操作
### 安装git
进入git官网下载git，安装好后通过```git config --global user.name"XXX"```以及```git config --global user.email"XXX"```配置好设备用户名和邮箱。

### 配置与连通github
1. 进入github网站创建账户  

2. 在git命令行中使用 ```ssh-keygen -t ed25519 -C "your_email@example.com"```命令创建ssh密钥对

3. 文件资源管理器中找到ssh文件，用记事本打开，复制公钥。

4. 在github中添加公钥

5. 命令行中输入```ssh -T git@github.com```验证连通成功

6. github中创建远程库

7. 在git中使用```git remote add origin git@github.com:XXX.git```连通远程库，此时远程库名字就是origin
### 遇到的问题和解决方法

|遇到的问题|原因|解决方法|  
|:---:|:---:|:---:|
|打不开github|连接请求超时|使用加速器|
|git无法配置用户名和邮箱|gitconfig文件开启了只读模式|关闭只读模式|
|文件commit时报错称找不到|文件名未区分大小写|严格按照文件名commit|

# 任务二 实现并发
## 学习非阻塞编程
### millis()函数
* 返回自程序启动时经过的时间（单位：毫秒）。

* 返回值类型为 unsigned long，可以记录约50天后清零。

* 记录时间流逝的基本思路：记下某个时间点，在未来的时间点检查是否超过了指定的时间间隔。
### blinkwithoutdelay 示例分析
* 总体效果：在不使用delay()函数时实现LED每秒亮（灭）一次
```c
 const int ledPin = LED_BUILTIN;  //设置LED连接的引脚


int ledState = LOW;  //设置初始引脚低电平状态

unsigned long previousMillis = 0;  //记录起始时间

// constants won't change:
const long interval = 1000;  //指定时间间隔(单位：毫秒)

void setup() {
  //设置引脚输出状态
  pinMode(ledPin, OUTPUT);
}

void loop() {
 
  unsigned long currentMillis = millis();
  //判断时间流逝是否超过设定范围
  if (currentMillis - previousMillis >= interval) {
    //重新设定起始时间，与当前时间一致，从而实现时间流逝的持续判断
    previousMillis = currentMillis;

    //自动改变引脚电平，以实现LED的亮灭
    if (ledState == LOW) {
      ledState = HIGH;
    } else {
      ledState = LOW;
    }
    digitalWrite(ledPin, ledState);
  }
}
```
* **对非阻塞的理解**：
  * ```delay()```函数使得```loop()```中断指定时间，中断期间无法完成程序的其他功能。

  * 使用```millis()```方法只需要检查是否达到指定时间，以条件判断代替了强制延时。配合循环函数使用，在相邻的闪烁期间内其他功能仍可正常运行。

## 代码重构
### DHT11传感器
#### 原理认识
* 供电电压：3.3V-5.5V

* 只有接收到开始信号后才触发温湿度采集。

* 电路连接
  * VCC引脚接开发板的3.3V引脚用于供电（不能用5V供电）。

  * GND引脚接开发板的GND引脚。

  * DATA引脚接开发板GPIO引脚，用于信号接收。
  

#### 相关代码
* **头文件```DHT11.h```**
* ```DHT11 dht11(pinmode)```：设置传感器名称为dht11,设置输出串口。

* ```dht11.readHumidity()```：读取湿度。
* ```dht11.readTemperature()```：读取温度。
* ```dht11.readTemperatureHumidity(temperature, humidity)```：同时读取温湿度，返回值类型为**int**。

## 实现过程
1. 准备DHT11传感器
2. 在Arduino中安装DHT11库

3. 学习BlinkwithoutDelay与DHT11的示例
4. 在一轮原代码的基础上优化，添加DHT11与非阻滞相关功能
5. 连接电路，上传程序，实现三线程并发。
